create procedure addCanadaPeriods 
	@periodname varchar(20),
	@encstart datetime,
	@encend datetime, 
	@projecteddate1 datetime, 
	@projecteddate2 datetime,
	@projecteddate3 datetime
as

create table #surveys (survey_id int)

insert into #surveys values (2350)
insert into #surveys values (2352)
insert into #surveys values (2206)
insert into #surveys values (2205)
insert into #surveys values (2207)
insert into #surveys values (2208)
insert into #surveys values (2981)
insert into #surveys values (2209)
insert into #surveys values (2417)
insert into #surveys values (2415)
insert into #surveys values (2414)
insert into #surveys values (3614)
insert into #surveys values (3615)
insert into #surveys values (3613)
insert into #surveys values (2291)
insert into #surveys values (2210)
insert into #surveys values (2212)
insert into #surveys values (2560)
insert into #surveys values (2559)
insert into #surveys values (2200)
insert into #surveys values (2190)
insert into #surveys values (2199)
insert into #surveys values (2455)
insert into #surveys values (2452)
insert into #surveys values (2710)
insert into #surveys values (2709)
insert into #surveys values (2401)
insert into #surveys values (2437)
insert into #surveys values (2436)
insert into #surveys values (2422)
insert into #surveys values (2376)
insert into #surveys values (2373)
insert into #surveys values (2974)
insert into #surveys values (2592)
insert into #surveys values (2593)
insert into #surveys values (2260)
insert into #surveys values (2262)
insert into #surveys values (2259)
insert into #surveys values (2355)
insert into #surveys values (2356)
insert into #surveys values (2404)
insert into #surveys values (2405)
insert into #surveys values (2403)
insert into #surveys values (2369)
insert into #surveys values (2370)
insert into #surveys values (2465)
insert into #surveys values (2464)
insert into #surveys values (2431)
insert into #surveys values (2428)
insert into #surveys values (2427)
insert into #surveys values (2413)
insert into #surveys values (2393)
insert into #surveys values (2472)
insert into #surveys values (2473)
insert into #surveys values (2594)
insert into #surveys values (2595)
insert into #surveys values (2589)
insert into #surveys values (2588)
insert into #surveys values (2214)
insert into #surveys values (2213)
insert into #surveys values (2349)
insert into #surveys values (2514)
insert into #surveys values (2513)
insert into #surveys values (2328)
insert into #surveys values (2326)
insert into #surveys values (2283)
insert into #surveys values (2279)
insert into #surveys values (2344)
insert into #surveys values (2343)
insert into #surveys values (2520)
insert into #surveys values (2519)
insert into #surveys values (2348)
insert into #surveys values (2346)
insert into #surveys values (2511)
insert into #surveys values (2510)
insert into #surveys values (2489)
insert into #surveys values (2490)
insert into #surveys values (2347)
insert into #surveys values (2345)
insert into #surveys values (2302)
insert into #surveys values (2299)
insert into #surveys values (2337)
insert into #surveys values (2342)
insert into #surveys values (2713)
insert into #surveys values (2714)
insert into #surveys values (2371)
insert into #surveys values (2365)
insert into #surveys values (2261)
insert into #surveys values (2263)
insert into #surveys values (2293)
insert into #surveys values (2294)
insert into #surveys values (2292)
insert into #surveys values (2335)
insert into #surveys values (2336)
insert into #surveys values (2485)
insert into #surveys values (2484)
insert into #surveys values (2333)
insert into #surveys values (2334)
insert into #surveys values (2251)
insert into #surveys values (2250)
insert into #surveys values (2584)
insert into #surveys values (2583)
insert into #surveys values (2586)
insert into #surveys values (2585)
insert into #surveys values (2732)
insert into #surveys values (2729)
insert into #surveys values (2731)
insert into #surveys values (2730)
insert into #surveys values (2734)
insert into #surveys values (2736)
insert into #surveys values (2844)
insert into #surveys values (2845)
insert into #surveys values (2486)
insert into #surveys values (2487)
insert into #surveys values (2492)
insert into #surveys values (2491)
insert into #surveys values (2329)
insert into #surveys values (2331)
insert into #surveys values (2530)
insert into #surveys values (2527)
insert into #surveys values (2324)
insert into #surveys values (2321)
insert into #surveys values (2410)
insert into #surveys values (2409)
insert into #surveys values (2412)
insert into #surveys values (2712)
insert into #surveys values (2711)
insert into #surveys values (2461)
insert into #surveys values (2482)
insert into #surveys values (2483)
insert into #surveys values (2468)
insert into #surveys values (2367)
insert into #surveys values (2238)
insert into #surveys values (2239)
insert into #surveys values (2237)
insert into #surveys values (2525)
insert into #surveys values (2524)
insert into #surveys values (2459)
insert into #surveys values (2597)
insert into #surveys values (2596)
insert into #surveys values (2453)
insert into #surveys values (2454)
insert into #surveys values (2423)
insert into #surveys values (2721)
insert into #surveys values (2720)
insert into #surveys values (2425)
insert into #surveys values (2456)
insert into #surveys values (2462)
insert into #surveys values (2722)
insert into #surveys values (2545)
insert into #surveys values (2544)
insert into #surveys values (2451)
insert into #surveys values (2450)
insert into #surveys values (2424)
insert into #surveys values (2280)
insert into #surveys values (2266)
insert into #surveys values (2267)
insert into #surveys values (2295)
insert into #surveys values (2297)
insert into #surveys values (2719)
insert into #surveys values (2718)
insert into #surveys values (2526)
insert into #surveys values (2523)
insert into #surveys values (2361)
insert into #surveys values (2364)
insert into #surveys values (3470)
insert into #surveys values (2374)
insert into #surveys values (2372)
insert into #surveys values (2327)
insert into #surveys values (2717)
insert into #surveys values (2792)
insert into #surveys values (2480)
insert into #surveys values (2332)
insert into #surveys values (2330)
insert into #surveys values (2284)
insert into #surveys values (2282)
insert into #surveys values (2300)
insert into #surveys values (2298)
insert into #surveys values (2296)
insert into #surveys values (2470)
insert into #surveys values (2471)
insert into #surveys values (3947)
insert into #surveys values (2305)
insert into #surveys values (2269)
insert into #surveys values (2448)
insert into #surveys values (2449)
insert into #surveys values (2426)
insert into #surveys values (2377)
insert into #surveys values (2375)
insert into #surveys values (2705)
insert into #surveys values (2706)
insert into #surveys values (2223)
insert into #surveys values (2222)
insert into #surveys values (2224)
insert into #surveys values (2975)
insert into #surveys values (2474)
insert into #surveys values (2441)
insert into #surveys values (2438)
insert into #surveys values (2429)
insert into #surveys values (2231)
insert into #surveys values (2229)
insert into #surveys values (2234)
insert into #surveys values (2318)
insert into #surveys values (2319)
insert into #surveys values (2308)
insert into #surveys values (2477)
insert into #surveys values (2475)
insert into #surveys values (2359)
insert into #surveys values (2362)
insert into #surveys values (2716)
insert into #surveys values (2715)
insert into #surveys values (2543)
insert into #surveys values (2542)
insert into #surveys values (2434)
insert into #surveys values (2272)
insert into #surveys values (2271)
insert into #surveys values (2270)
insert into #surveys values (2421)
insert into #surveys values (2707)
insert into #surveys values (2696)
insert into #surveys values (2420)
insert into #surveys values (2733)
insert into #surveys values (2735)
insert into #surveys values (2236)
insert into #surveys values (2600)
insert into #surveys values (2601)
insert into #surveys values (2384)
insert into #surveys values (2383)
insert into #surveys values (2382)
insert into #surveys values (2590)
insert into #surveys values (2591)
insert into #surveys values (2540)
insert into #surveys values (2541)
insert into #surveys values (2478)
insert into #surveys values (2479)
insert into #surveys values (2493)
insert into #surveys values (2494)
insert into #surveys values (2268)
insert into #surveys values (2265)
insert into #surveys values (2301)
insert into #surveys values (2539)
insert into #surveys values (2538)
insert into #surveys values (2247)
insert into #surveys values (2246)
insert into #surveys values (2248)

declare @survey_id int, @perioddef_id int
select top 1 @survey_id=survey_id from #surveys

While @@rowcount > 0
Begin
	insert into perioddef (Survey_id,Employee_id,datAdded,strPeriodDef_nm,intExpectedSamples,
		DaysToSample,datExpectedEncStart,datExpectedEncEnd,strDayOrder,Recurrence,MonthWeek,
		SamplingMethod_id,intDayofMonth)
	values (@survey_id, 263, getdate(),@periodname,3,2,@encstart,@encend,
			null, 1,'M', 2, null)

	SET @Perioddef_id=@@identity

	insert into perioddates (perioddef_id, samplenumber, datscheduledsample_dt)
	values (@perioddef_id, 1, @projecteddate1)
	insert into perioddates (perioddef_id, samplenumber, datscheduledsample_dt)
	values (@perioddef_id, 2, @projecteddate2)
	insert into perioddates (perioddef_id, samplenumber, datscheduledsample_dt)
	values (@perioddef_id, 3, @projecteddate3)

	delete from #surveys where survey_id=@survey_id
	select top 1 @survey_id=survey_id from #surveys
End

drop table #surveys


