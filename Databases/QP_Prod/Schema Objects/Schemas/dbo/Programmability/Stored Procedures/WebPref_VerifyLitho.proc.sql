CREATE PROCEDURE WebPref_VerifyLitho @BarCode VARCHAR(8)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET NOCOUNT ON

DECLARE @Litho VARCHAR(20)

SELECT @Litho=dbo.BarCodeToLitho(@BarCode,1)

IF @Litho<1 OR @Litho IS NULL
BEGIN
	SELECT -1
	RETURN
END
ELSE
BEGIN

	IF EXISTS (SELECT * FROM SentMailing WHERE strLithoCode=@Litho)
	BEGIN
		SELECT @Litho
		RETURN
	END
	ELSE 
	BEGIN
		SELECT -1
		RETURN
	END

END

SET TRANSACTION ISOLATION LEVEL READ COMMITTED
SET NOCOUNT OFF


